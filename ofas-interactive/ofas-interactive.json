{"kind":"Notebook","sha256":"238408a65d74c4c5f0399b979985a61b8857c9278d68fed55aa8ccc8ac7a5155","slug":"ofas-interactive","dependencies":[],"frontmatter":{"title":"Ofas Interactive Applications","authors":[],"github":"https://github.com/sigmarkarl/sigmarkarlhub.io","keywords":[],"exports":[{"format":"ipynb","filename":"ofas-interactive.ipynb","url":"/ofas-interactive/build/ofas-interactive-656f04543281931a5ffeccebc63cd117.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":4,"column":0},"end":{"line":5,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":6,"column":0},"end":{"line":7,"column":0}},"children":[{"type":"text","value":"Introduction","key":"pPXZJekmM9"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"Up29ORa8dJ"},{"type":"paragraph","position":{"start":{"line":8,"column":0},"end":{"line":9,"column":0}},"children":[{"type":"text","value":"An interactive Spark application is a long-running application which the user can interact with on runtime. This can be a notebook application or applications running Spark Connect or HiveThrift servers. Spark Connect supports languages such as Python, Scala and Go and potentially all languages supported by gRPC. The HiveThrift server offers SQL interaction through JDBC.","key":"ZZHN4oPGif"}],"key":"z25MwvsAs5"}],"data":{"id":"nb-cell-1-58b7d04b96","type":"notebook-content"},"identifier":"nb-cell-1-58b7d04b96","label":"nb-cell-1-58b7d04b96","html_id":"nb-cell-1-58b7d04b96","key":"uMss4tP3wu"},{"type":"block","position":{"start":{"line":10,"column":0},"end":{"line":11,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":12,"column":0},"end":{"line":13,"column":0}},"children":[{"type":"text","value":"Spark Connect","key":"Zjm5T75G6E"}],"identifier":"spark-connect","label":"Spark Connect","html_id":"spark-connect","implicit":true,"key":"tVyRO2SrM6"}],"data":{"id":"nb-cell-2-abf3b7c6fd","type":"notebook-content"},"identifier":"nb-cell-2-abf3b7c6fd","label":"nb-cell-2-abf3b7c6fd","html_id":"nb-cell-2-abf3b7c6fd","key":"hcqCZsjaIq"},{"type":"block","position":{"start":{"line":14,"column":0},"end":{"line":15,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":16,"column":0},"end":{"line":17,"column":0}},"children":[{"type":"text","value":"Server side","key":"mpv1V98w1Y"}],"identifier":"server-side","label":"Server side","html_id":"server-side","implicit":true,"key":"QZBKWLlUCD"},{"type":"paragraph","position":{"start":{"line":17,"column":0},"end":{"line":18,"column":0}},"children":[{"type":"text","value":"To start a Spark application with SparkConnect server, either run the mainClass SparkConnectServer or enable the SparkConnect plugin. Using the Spark Connect plugin, the application can run other tasks or services while enabling Spark Connect.","key":"ytAX88V28p"}],"key":"rdpRMG7FnA"}],"data":{"id":"nb-cell-3-8e142c2229","type":"notebook-content"},"identifier":"nb-cell-3-8e142c2229","label":"nb-cell-3-8e142c2229","html_id":"nb-cell-3-8e142c2229","key":"q5jasuRlmt"},{"type":"block","position":{"start":{"line":19,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":21,"column":0},"end":{"line":22,"column":0}},"children":[{"type":"text","value":"Spark Connect launch using the SparkConnectServer","key":"QDB6TXnoSk"}],"identifier":"spark-connect-launch-using-the-sparkconnectserver","label":"Spark Connect launch using the SparkConnectServer","html_id":"spark-connect-launch-using-the-sparkconnectserver","implicit":true,"key":"jcw1Ym2R9F"},{"type":"code","lang":"json","value":"\"mainClass\": \"org.apache.spark.connect.sql.service.SparkConnectServer\",\n\"deps\": {\n    \"packages\": [\"org.apache.spark:spark-connect_2.12:3.5.0\"]\n}","position":{"start":{"line":22,"column":0},"end":{"line":28,"column":0}},"identifier":"nb-cell-4-0ae4c53369-code","enumerator":"1","html_id":"nb-cell-4-0ae4c53369-code","key":"r7S1KYNXHo"}],"data":{"id":"nb-cell-4-0ae4c53369","type":"notebook-content"},"identifier":"nb-cell-4-0ae4c53369","label":"nb-cell-4-0ae4c53369","html_id":"nb-cell-4-0ae4c53369","key":"r6j7taHMBn"},{"type":"block","position":{"start":{"line":29,"column":0},"end":{"line":30,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":31,"column":0},"end":{"line":32,"column":0}},"children":[{"type":"text","value":"Spark Connect launch using the Spark Connect plugin","key":"np2gg0jtBp"}],"identifier":"spark-connect-launch-using-the-spark-connect-plugin","label":"Spark Connect launch using the Spark Connect plugin","html_id":"spark-connect-launch-using-the-spark-connect-plugin","implicit":true,"key":"fLbYyYwsPx"},{"type":"code","lang":"json","value":"\"sparkConf\": {\n    \"spark.plugins\": \"org.apache.spark.sql.connect.SparkConnectPlugin\"\n},\n\"deps\": {\n    \"packages\": [\"org.apache.spark:spark-connect_2.12:3.5.0\"]\n}","position":{"start":{"line":32,"column":0},"end":{"line":40,"column":0}},"identifier":"nb-cell-5-7d2ac785d8-code","enumerator":"2","html_id":"nb-cell-5-7d2ac785d8-code","key":"EnLYvmYkhy"}],"data":{"id":"nb-cell-5-7d2ac785d8","type":"notebook-content"},"identifier":"nb-cell-5-7d2ac785d8","label":"nb-cell-5-7d2ac785d8","html_id":"nb-cell-5-7d2ac785d8","key":"Wy2ijtd3dW"},{"type":"block","position":{"start":{"line":41,"column":0},"end":{"line":42,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":43,"column":0},"end":{"line":44,"column":0}},"children":[{"type":"text","value":"Client side","key":"z5YjAbJEvi"}],"identifier":"client-side","label":"Client side","html_id":"client-side","implicit":true,"key":"PImMTxaT4F"},{"type":"heading","depth":4,"position":{"start":{"line":44,"column":0},"end":{"line":45,"column":0}},"children":[{"type":"text","value":"Python library","key":"H37KseLtLA"}],"identifier":"python-library","label":"Python library","html_id":"python-library","implicit":true,"key":"G14XyCjP2d"},{"type":"paragraph","position":{"start":{"line":45,"column":0},"end":{"line":46,"column":0}},"children":[{"type":"text","value":"On the client side use the ocean-spark-connect (","key":"VvHMakj2HM"},{"type":"link","url":"https://pypi.org/project/ocean-spark-connect","children":[{"type":"text","value":"https://​​pypi​​.org​​/project​​/ocean​​-spark​​-connect","key":"AkyWhMHamY"}],"urlSource":"https://pypi.org/project/ocean-spark-connect","key":"Mzjn6AweGc"},{"type":"text","value":") python library to interact with the Spark Connect session","key":"mG1xAo1V2G"}],"key":"PMKNTUJ2yj"}],"data":{"id":"nb-cell-6-be6eb731f3","type":"notebook-content"},"identifier":"nb-cell-6-be6eb731f3","label":"nb-cell-6-be6eb731f3","html_id":"nb-cell-6-be6eb731f3","key":"nwlfIfEyzh"},{"type":"block","position":{"start":{"line":47,"column":0},"end":{"line":48,"column":0}},"children":[{"type":"code","lang":"python","value":"from ocean_spark_connect.ocean_spark_session import OceanSparkSession\n\nspark = OceanSparkSession.Builder().cluster_id(\"osc-cluster\").appid(\"appid\").profile(\"default\").getOrCreate()\nspark.sql(\"select random()\").show()\nspark.stop()","position":{"start":{"line":49,"column":0},"end":{"line":56,"column":0}},"identifier":"nb-cell-7-305cbf1ff7-code","enumerator":"3","html_id":"nb-cell-7-305cbf1ff7-code","key":"qhMNbj7kzc"}],"data":{"id":"nb-cell-7-305cbf1ff7","type":"notebook-content"},"identifier":"nb-cell-7-305cbf1ff7","label":"nb-cell-7-305cbf1ff7","html_id":"nb-cell-7-305cbf1ff7","key":"C6QE1mrPUb"},{"type":"block","position":{"start":{"line":57,"column":0},"end":{"line":58,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":59,"column":0},"end":{"line":60,"column":0}},"children":[{"type":"text","value":"Spotctl","key":"FVE0onAyQd"}],"identifier":"spotctl","label":"Spotctl","html_id":"spotctl","implicit":true,"key":"SbYrauShMX"},{"type":"paragraph","position":{"start":{"line":60,"column":0},"end":{"line":61,"column":0}},"children":[{"type":"text","value":"Use the spotctl command line tool to open a websocket proxy to the interactive Spark application","key":"VeeI7NYAVj"}],"key":"rHwDFots5h"}],"data":{"id":"nb-cell-8-58550d501c","type":"notebook-content"},"identifier":"nb-cell-8-58550d501c","label":"nb-cell-8-58550d501c","html_id":"nb-cell-8-58550d501c","key":"BoPbbspE0F"},{"type":"block","position":{"start":{"line":62,"column":0},"end":{"line":63,"column":0}},"children":[{"type":"code","lang":"sh","value":"brew install spotinst/tap/spotctl\nspotctl configure","position":{"start":{"line":64,"column":0},"end":{"line":68,"column":0}},"identifier":"nb-cell-9-58a717690e-code","enumerator":"4","html_id":"nb-cell-9-58a717690e-code","key":"s4mX40mefZ"}],"data":{"id":"nb-cell-9-58a717690e","type":"notebook-content"},"identifier":"nb-cell-9-58a717690e","label":"nb-cell-9-58a717690e","html_id":"nb-cell-9-58a717690e","key":"k0Xy6V3GiT"},{"type":"block","position":{"start":{"line":69,"column":0},"end":{"line":70,"column":0}},"children":[{"type":"code","lang":"sh","value":"spotctl ocean spark --clusterid osc-cluster --appid appid --profile default","position":{"start":{"line":71,"column":0},"end":{"line":74,"column":0}},"identifier":"nb-cell-10-5824975ebd-code","enumerator":"5","html_id":"nb-cell-10-5824975ebd-code","key":"V6dKs6izLr"}],"data":{"id":"nb-cell-10-5824975ebd","type":"notebook-content"},"identifier":"nb-cell-10-5824975ebd","label":"nb-cell-10-5824975ebd","html_id":"nb-cell-10-5824975ebd","key":"E4ZAvySNoI"},{"type":"block","position":{"start":{"line":75,"column":0},"end":{"line":76,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":77,"column":0},"end":{"line":78,"column":0}},"children":[{"type":"text","value":"spotctl will start a service on port 15002 (the default Spark Connect port)","key":"NwApHcOzEs"}],"key":"qVn3Qco4Tz"},{"type":"code","lang":"sh","value":"pyspark --remote sc://localhost","position":{"start":{"line":79,"column":0},"end":{"line":82,"column":0}},"identifier":"nb-cell-11-0227b6e860-code","enumerator":"6","html_id":"nb-cell-11-0227b6e860-code","key":"L9nsP6Se8J"}],"data":{"id":"nb-cell-11-0227b6e860","type":"notebook-content"},"identifier":"nb-cell-11-0227b6e860","label":"nb-cell-11-0227b6e860","html_id":"nb-cell-11-0227b6e860","key":"h3AEcF3jcl"},{"type":"block","position":{"start":{"line":83,"column":0},"end":{"line":84,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":85,"column":0},"end":{"line":86,"column":0}},"children":[{"type":"text","value":"JDBC","key":"WkeklYeFW7"}],"identifier":"jdbc","label":"JDBC","html_id":"jdbc","implicit":true,"key":"vwxLxGkJ1O"},{"type":"heading","depth":3,"position":{"start":{"line":86,"column":0},"end":{"line":87,"column":0}},"children":[{"type":"text","value":"Server side","key":"WXMnntWyqy"}],"identifier":"server-side","label":"Server side","html_id":"server-side-1","implicit":true,"key":"UDwfWpQ0Ud"},{"type":"paragraph","position":{"start":{"line":87,"column":0},"end":{"line":88,"column":0}},"children":[{"type":"text","value":"To enable JDBC connections to the Spark Application, start the HiveThriftServer","key":"WWNGWaraNU"}],"key":"wgHu5KxMx3"}],"data":{"id":"nb-cell-12-31a07d2aa3","type":"notebook-content"},"identifier":"nb-cell-12-31a07d2aa3","label":"nb-cell-12-31a07d2aa3","html_id":"nb-cell-12-31a07d2aa3","key":"wFsdjeH69P"},{"type":"block","position":{"start":{"line":89,"column":0},"end":{"line":90,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":91,"column":0},"end":{"line":92,"column":0}},"children":[{"type":"text","value":"Launch a JDBC server","key":"W6ZGPMXbN3"}],"identifier":"launch-a-jdbc-server","label":"Launch a JDBC server","html_id":"launch-a-jdbc-server","implicit":true,"key":"SmH5RMv9aF"},{"type":"code","lang":"json","value":"\"mainClass\": \"com.netapp.spark.HiveThriftServer\",\n\"deps\": {\n    \"packages\": [\"com.netapp.spark:hive:1.2.0\"],\n    \"repositories\": [\"https://us-central1-maven.pkg.dev/ocean-spark/spark-code-submission-plugin\"]\n}","position":{"start":{"line":92,"column":0},"end":{"line":99,"column":0}},"identifier":"nb-cell-13-5f77298a22-code","enumerator":"7","html_id":"nb-cell-13-5f77298a22-code","key":"mMzLZFYekg"}],"data":{"id":"nb-cell-13-5f77298a22","type":"notebook-content"},"identifier":"nb-cell-13-5f77298a22","label":"nb-cell-13-5f77298a22","html_id":"nb-cell-13-5f77298a22","key":"mYdvmgSepG"},{"type":"block","position":{"start":{"line":100,"column":0},"end":{"line":101,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":102,"column":0},"end":{"line":103,"column":0}},"children":[{"type":"text","value":"Client side","key":"ZyGlHQGEfq"}],"identifier":"client-side","label":"Client side","html_id":"client-side-1","implicit":true,"key":"WA0MKdBCVU"}],"data":{"id":"nb-cell-14-24712a82e4","type":"notebook-content"},"identifier":"nb-cell-14-24712a82e4","label":"nb-cell-14-24712a82e4","html_id":"nb-cell-14-24712a82e4","key":"XO8gcmOckE"},{"type":"block","position":{"start":{"line":104,"column":0},"end":{"line":105,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":106,"column":0},"end":{"line":107,"column":0}},"children":[{"type":"text","value":"Ofas JDBC driver","key":"hNCTqY0SI5"}],"identifier":"ofas-jdbc-driver","label":"Ofas JDBC driver","html_id":"ofas-jdbc-driver","implicit":true,"key":"itvzEci7Re"},{"type":"paragraph","position":{"start":{"line":107,"column":0},"end":{"line":108,"column":0}},"children":[{"type":"text","value":"Use the Ofas JDBC driver with database tool or in your code project. The driver available at the following maven coordinates","key":"rf5c5hWpV4"}],"key":"cmsslGkjCW"},{"type":"code","lang":"","value":"com.netapp.spark:ofas-jdbc:1.2.0","position":{"start":{"line":108,"column":0},"end":{"line":111,"column":0}},"identifier":"nb-cell-15-84b6ad3514-code-0","enumerator":"8","html_id":"nb-cell-15-84b6ad3514-code-0","key":"J68zVu7PZ5"},{"type":"paragraph","position":{"start":{"line":111,"column":0},"end":{"line":112,"column":0}},"children":[{"type":"text","value":"Use the following public maven repository","key":"BNoMxUc1Bj"}],"key":"hw4akgmJxm"},{"type":"code","lang":"","value":"https://us-central1-maven.pkg.dev/ocean-spark/spark-code-submission-plugin","position":{"start":{"line":112,"column":0},"end":{"line":115,"column":0}},"identifier":"nb-cell-15-84b6ad3514-code-1","enumerator":"9","html_id":"nb-cell-15-84b6ad3514-code-1","key":"jlgRZr2bRc"}],"data":{"id":"nb-cell-15-84b6ad3514","type":"notebook-content"},"identifier":"nb-cell-15-84b6ad3514","label":"nb-cell-15-84b6ad3514","html_id":"nb-cell-15-84b6ad3514","key":"I8abLoWfpw"},{"type":"block","position":{"start":{"line":116,"column":0},"end":{"line":117,"column":0}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":118,"column":0},"end":{"line":119,"column":0}},"children":[{"type":"text","value":"Spotctl","key":"D1rlMAk4ul"}],"identifier":"spotctl","label":"Spotctl","html_id":"spotctl-1","implicit":true,"key":"CiQhUxYpPr"},{"type":"paragraph","position":{"start":{"line":119,"column":0},"end":{"line":120,"column":0}},"children":[{"type":"text","value":"Use the spotctl command line tool as above, with the port option, --port 10000 or --port hive","key":"cws6zX3EEf"}],"key":"soiVeEgsEi"},{"type":"code","lang":"","value":"spotctl ocean spark --clusterid osc-cluster --appid appid --profile default --port hive","position":{"start":{"line":120,"column":0},"end":{"line":123,"column":0}},"identifier":"nb-cell-16-819cc2a17b-code","enumerator":"10","html_id":"nb-cell-16-819cc2a17b-code","key":"fPqZFkksR1"},{"type":"paragraph","position":{"start":{"line":123,"column":0},"end":{"line":124,"column":0}},"children":[{"type":"text","value":"The user can now connect to the interactive Spark application through a Hive Thrift library or the Hive JDBC driver.","key":"hkaEOilZt0"}],"key":"ahzXlFrj99"}],"data":{"id":"nb-cell-16-819cc2a17b","type":"notebook-content"},"identifier":"nb-cell-16-819cc2a17b","label":"nb-cell-16-819cc2a17b","html_id":"nb-cell-16-819cc2a17b","key":"MuVFTNl5iD"}],"key":"k2B0A77NOn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{}},"domain":"http://localhost:3004"}